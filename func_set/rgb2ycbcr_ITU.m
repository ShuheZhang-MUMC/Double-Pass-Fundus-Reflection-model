function out = rgb2ycbcr_ITU(in)
Kr = 0.299;
Kg = 0.587;
Kb = 1 - Kr - Kg;

A = [            Kr,              Kg,              Kb;...
     -1/2*Kr/(1-Kb),  -1/2*Kg/(1-Kb),             1/2;...
                1/2,  -1/2*Kg/(1-Kr),  -1/2*Kb/(1-Kr)];

out(:,:,1) = A(1,1) * in(:,:,1) + A(1,2) * in(:,:,2) + A(1,3) * in(:,:,3);
out(:,:,2) = A(2,1) * in(:,:,1) + A(2,2) * in(:,:,2) + A(2,3) * in(:,:,3);
out(:,:,3) = A(3,1) * in(:,:,1) + A(3,2) * in(:,:,2) + A(3,3) * in(:,:,3);

end